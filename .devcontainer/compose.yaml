services:
    gateway:
        build:
            context: ..
            dockerfile: Dockerfile
        ports:
            - "15888:15888"
        volumes:
            - ../conf:/home/gateway/conf
            - ../logs:/home/gateway/logs  
            - ../db:/home/gateway/db
            - ../certs:/home/gateway/certs
        environment:
            - DEV=true
            - GATEWAY_PASSPHRASE=12345
        command: ["sh", "-c", "if [ \"$$DEV\" = \"true\" ]; then pnpm start --passphrase=\"$$GATEWAY_PASSPHRASE\" --dev; else pnpm start; fi"]
        restart: always
